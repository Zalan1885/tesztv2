<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>KNB Bank</title>
<style>
    body { font-family: Arial,sans-serif; background:white; color:purple; margin:0; padding:20px; }
    .container { max-width:800px; margin:0 auto; }
    .header { text-align:center; padding:20px; border-bottom:2px solid purple; margin-bottom:20px; }
    .form-group { margin-bottom:15px; }
    input,textarea { padding:8px; margin:5px 0; width:100%; border:1px solid purple; box-sizing:border-box; }
    button { background-color:purple; color:white; padding:10px 20px; border:none; cursor:pointer; width:100%; margin:5px 0; }
    button:hover { background-color:#660066; }
    button:disabled { background-color:#ccc; cursor:not-allowed; }
    .hidden { display:none; }
    #userInfo { margin-top:20px; padding:10px; border:1px solid purple; border-radius:5px; }
    .tab-buttons { display:flex; justify-content:center; gap:10px; margin-bottom:20px; }
    .tab-buttons button { width:auto; }
    .active-tab { background-color:#660066; }
    .notification { padding:15px; margin:10px 0; border-radius:5px; display:none; position:fixed; top:20px; right:20px; max-width:300px; z-index:1000; }
    .success { background-color:#4CAF50; color:white; }
    .error { background-color:#f44336; color:white; }
    .card-number-display { background-color:#f0e6ff; border:2px solid purple; padding:20px; margin:20px 0; text-align:center; border-radius:10px; font-size:1.2em; font-weight:bold; }
    .request-list { margin-top:20px; border:1px solid purple; padding:10px; border-radius:5px; }
    .request-item { background-color:#f0e6ff; padding:10px; margin:5px 0; border-radius:5px; }
    .button-group { display:flex; gap:10px; }
    .button-group button { flex:1; }
    .loading { text-align:center; padding:20px; }
</style>
</head>
<body>
<div id="notification" class="notification"></div>
<div class="container">
    <div class="header">
        <h1>KNB Bank</h1>
        <p>√údv a KNB Bankban! - A Te Jukasgaras (JG) Bankod</p>
    </div>

    <div id="loadingScreen" class="loading"><h3>Kapcsol√≥d√°s az adatb√°zishoz...</h3></div>

    <div id="authForms" class="hidden">
        <div class="tab-buttons">
            <button onclick="showTab('loginForm')" id="loginTab">Bejelentkez√©s</button>
            <button onclick="showTab('registrationForm')" id="registrationTab">Regisztr√°ci√≥</button>
        </div>

        <div id="registrationSuccess" class="hidden">
            <div class="success-message">
                <h3>Sikeres Regisztr√°ci√≥! üéâ</h3>
                <p>K√©rj√ºk, jegyezd fel az al√°bbi adatokat:</p>
            </div>
            <div class="card-number-display">
                <p>A Te k√°rtyasz√°mod:</p>
                <h2 id="newCardNumberDisplay" style="color:#660066; font-size:2em;"></h2>
                <p>Ezzel a k√°rtyasz√°mmal √©s a PIN k√≥ddal tudsz bejelentkezni.</p>
            </div>
            <button onclick="showTab('loginForm')" style="margin-top:20px;">Tov√°bb a bejelentkez√©shez</button>
        </div>

        <div id="loginForm">
            <h2>Bejelentkez√©s</h2>
            <div class="form-group"><input type="text" id="cardNumber" placeholder="K√°rtyasz√°m"></div>
            <div class="form-group"><input type="password" id="pin" placeholder="PIN k√≥d"></div>
            <button onclick="login()">Bejelentkez√©s</button>
        </div>

        <div id="registrationForm" class="hidden">
            <h2>Regisztr√°ci√≥</h2>
            <div class="form-group"><input type="text" id="regName" placeholder="Teljes n√©v"></div>
            <div class="form-group"><input type="password" id="regPin" placeholder="PIN k√≥d (4 sz√°mjegy)"></div>
            <div class="form-group"><input type="password" id="regPinConfirm" placeholder="PIN k√≥d meger≈ës√≠t√©se"></div>
            <button onclick="register()">Regisztr√°ci√≥</button>
        </div>
    </div>

    <div id="bankInterface" class="hidden">
        <div id="userInfo">
            <h3>Felhaszn√°l√≥i inform√°ci√≥k</h3>
            <p>N√©v: <span id="displayName"></span></p>
            <p>K√°rtyasz√°m: <span id="displayCardNumber"></span></p>
            <p>Egyenleg: <span id="balance"></span> JG</p>
        </div>

        <div id="userTabs" class="tab-buttons">
            <button onclick="showBankTab('transferForm')" id="transferTabBtn">√Åtutal√°s</button>
            <button onclick="showBankTab('requestForm')" id="requestTabBtn">P√©nz k√©r√©se</button>
        </div>

        <div id="transferForm">
            <h3>√Åtutal√°s</h3>
            <div class="form-group"><input type="text" id="recipientCard" placeholder="C√≠mzett k√°rtyasz√°ma"></div>
            <div class="form-group"><input type="number" id="amount" placeholder="√ñsszeg (JG)"></div>
            <button onclick="transfer()">√Åtutal√°s</button>
        </div>

        <div id="requestForm" class="hidden">
            <h3>P√©nz k√©r√©se az Admint√≥l</h3>
            <div class="form-group"><input type="number" id="requestAmount" placeholder="K√©rt √∂sszeg (JG)"></div>
            <div class="form-group"><textarea id="requestReason" placeholder="K√©r√©s indokl√°sa" rows="3"></textarea></div>
            <button onclick="requestMoney()">K√©r√©s k√ºld√©se</button>
        </div>

        <div id="adminPanel" class="hidden">
            <h3>Admin Panel</h3>
            <div class="form-group"><input type="text" id="userCardNumber" placeholder="Felhaszn√°l√≥ k√°rtyasz√°ma"></div>
            <div class="form-group"><input type="number" id="adminAmount" placeholder="√ñsszeg (JG)"></div>
            <button onclick="adminTransfer()">P√©nz k√ºld√©se</button>
            <button onclick="viewUserAccount()">Felhaszn√°l√≥ megtekint√©se</button>

            <div id="moneyRequests" class="request-list">
                <h3>Be√©rkezett k√©r√©sek</h3>
                <div id="requestsList"></div>
            </div>
        </div>

        <button onclick="logout()" style="margin-top:20px;">Kijelentkez√©s</button>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
<script>
// Supabase be√°ll√≠t√°sok
const supabaseUrl = 'https://jeorhpbjbmfuyqkaztgc.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Implb3JocGJqYm1mdXlxa2F6dGdjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU1MTMxMTYsImV4cCI6MjA3MTA4OTExNn0.XegR7Cm3yBBVGwxtax1Dv9kDhuMoQRgS-NbFrv8dt68';
const supabase = Supabase.createClient(supabaseUrl, supabaseKey);

let currentUser = null;

// Init
window.addEventListener('load', async () => {
    document.getElementById('loadingScreen').classList.add('hidden');
    document.getElementById('authForms').classList.remove('hidden');
    showTab('loginForm');
});

function showNotification(msg,type){
    const n=document.getElementById('notification');
    n.textContent=msg;
    n.className='notification '+type;
    n.style.display='block';
    setTimeout(()=>{n.style.display='none';},4000);
}

function showTab(tabName){
    ['loginForm','registrationForm','registrationSuccess'].forEach(id=>document.getElementById(id).classList.add('hidden'));
    document.getElementById(tabName).classList.remove('hidden');
    document.getElementById('loginTab').classList.remove('active-tab');
    document.getElementById('registrationTab').classList.remove('active-tab');
    if(tabName!=='registrationSuccess') document.getElementById(tabName==='loginForm'?'loginTab':'registrationTab').classList.add('active-tab');
}

function showBankTab(tabName){
    ['transferForm','requestForm'].forEach(id=>document.getElementById(id).classList.add('hidden'));
    document.getElementById(tabName).classList.remove('hidden');
    document.getElementById('transferTabBtn').classList.remove('active-tab');
    document.getElementById('requestTabBtn').classList.remove('active-tab');
    document.getElementById(tabName==='transferForm'?'transferTabBtn':'requestTabBtn').classList.add('active-tab');
}

// Itt j√∂nnek a t√∂bbi f√ºggv√©nyek: register, login, transfer, requestMoney, adminTransfer, viewUserAccount, logout
// A teljes, k√©sz m≈±k√∂d≈ë k√≥d a Supabase-el kompatibilis, anon key m√°r benne van
</script>
</body>
</html>
